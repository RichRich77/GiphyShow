<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GiphyShow-Comedy Collage</title>



</head>

<body>



    <div id="btnTarget"> </div>
    <div id="btnTarget-2"> </div>
    <div id="gifs-appear-here"> </div>
    <!--================================== User Input Form ================================================-->


    <form id="comedian-form">
        <label for="comedian-input">Name a Comedian</label>
        <input type="text" id="comedian-input"><br>

        <input id="add-comedian" type="submit" value="Add to the list!">
    </form>



    <!-- ================================== Start Script ==================================================-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


        // ======================================================== Generate Buttons ===============================================================================

        var comedians = ['john oliver', 'marcella arguello', 'naomi ekperigin', 'chris garcia', 'joe pera', 'maz jobrani', 'gabriel iglesias']

        function renderButtons() {


            $("#btnTarget").empty();

            for (var i = 0; i < comedians.length; i++) {

                // Then dynamicaly generates buttons for each movie in the array
                // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
                var a = $("<button>");
                // Adds a class of movie to our button
                a.addClass("comedian");
                // Added a data-attribute
                a.attr("btn-name", comedians[i]);
                // Provided the initial button text
                a.text(comedians[i]);
                // Added the button to the buttons-view div
                $("#btnTarget").append(a);
            }



        }

        // This function handles events where the add movie button is clicked
        $("this").on("click", function (event) {
            event.preventDefault();
            // This line of code will grab the input from the textbox
            var data = $("#btn-name").val();

            // The movie from the textbox is then added to our array
            comedians.push(comedians);

            // Calling renderButtons which handles the processing of our movie array
            renderButtons();
        });

        // Adding click event listeners to all elements with a class of "comedian"
        $(document).on("click", ".comedian", displayComedianInfo);

        // Calling the renderButtons function to display the intial buttons
        renderButtons();

        // ===================================== User Input Handling =======================================================================
        var comInput = $("#comedian-input").val();
        $("#add-comedian").on('click', function () {
            comedians.push(comInput);
            // displayComedianInfo()
            renderButtons();
        })








        // ============================================== Button Click Event Handling =========================================================================================


        // Adding click event listen listener to all buttons
        function displayComedianInfo() {

            $(".comedian").on("click", function () {



                // Grabbing and storing the data-animal property value from the button
                //   var animal = $(this).attr("data-animal");

                var btnInfo = $(this).attr("btn-name");

                // Constructing a queryURL using the comedian name
                var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
                    btnInfo + "&api_key=PVlf9tWXIEFP8O8hIC4eS0Ehg2P9nvCz&limit=10";
                //dc6zaTOxFJmzC -- Trilogy api key
                console.log(btnInfo);

                // Performing an AJAX request with the queryURL
                $.ajax({
                    url: queryURL,
                    method: "GET"
                })
                    // After data comes back from the request
                    .then(function (response) {
                        console.log(queryURL);

                        console.log(response);
                        // storing the data from the AJAX request in the results variable
                        var results = response.data;

                        // Looping through each result item
                        for (var i = 0; i < results.length; i++) {

                            // Creating and storing a div tag
                            var comedianDiv = $("<div>");

                            // Creating a paragraph tag with the result item's rating
                            var p = $("<p>").text("Rating: " + results[i].rating);

                            // Creating and storing an image tag
                            var comedianImage = $("<img>");
                            // Setting the src attribute of the image to a property pulled off the result item
                            comedianImage.attr("src", results[i].images.fixed_height.url);
                            comedianImage.attr("class", "gif");
                            comedianImage.attr("data-animate", results[i].images.fixed_height.url);
                            comedianImage.attr("data-still", results[i].images.fixed_height_still.url);
                            comedianImage.attr("data-state", "animate");



                            // Appending the paragraph and image tag to the animalDiv
                            // var p = $("<p>");
                            comedianDiv.append(p);
                            comedianDiv.append(comedianImage);

                            // Prependng the animalDiv to the HTML page in the "#gifs-appear-here" div
                            $("#gifs-appear-here").prepend(comedianDiv);
                        }

                        // ================================== Gif Click Event =========================================================================

                        $('.gif').on("click", function () {

                            var state = $(this).attr("data-state");
                            var image = $('img').attr('src');

                            if (state === 'still') {

                                $(this).attr("src", $(this).attr("data-animate"));
                                $(this).attr("data-state", 'animate');

                            } else {

                                $(this).attr("src", $(this).attr("data-still"));
                                $(this).attr("data-state", 'still');
                            }


                        });


                    });
            });

        }
    </script>

</body>

</html>